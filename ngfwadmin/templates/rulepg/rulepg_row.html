<div class="row" style="background-color: lightgrey">
    <div style="height: 1px;"></div>
</div>

<div class="row_focus row py-1" onclick="row_click(this)">
    <!-- Название правила -->
    <div class="col px-1 mx-0 cell_focus" onclick="cell_click(this)">
    
        <label for="status_{{ rule.id }}" hidden=></label>
        <select id="status_{{ rule.id }}" class="border-0 text-info mb-0"
                style="-webkit-appearance: none; -moz-appearance: none; background: transparent">
            <option value="0" {% if rule.status == 0 %}selected{% endif %}>Выкл</option>
            <option value="1" {% if rule.status == 1 %}selected{% endif %}>Запрещено</option>
            <option value="2" {% if rule.status == 2 %}selected{% endif %}>Разрешено</option>
        </select>
    
        <div class="input-group" style="background: #0000;">
            <div class="input-group-prepend editor_on p-t-5" hidden>
                <i class="feather icon-check text-info" style="cursor: pointer;"
                onclick="{
                            // получить параметры
                            let id_rule = {{ rule.id }};
                            let name_rule = document.getElementById('name_{{ rule.id }}').value;
                            let status_rule = Number(document.getElementById('status_{{ rule.id }}').value);    
                            // поменять отображение
                            document.getElementById('label_name_{{ rule.id }}').text = name_rule;                                
                            // выполнить запрос
                            $.ajax({
                                type: 'GET',
                                dataType: 'json',
                                data: {db_func: 'filter.web_rule_update',
                                       db_param: JSON.stringify([id_rule, name_rule, status_rule]) },
                                url: '{% url 'rulepg' %}',
                                success: completed
                            });
                            // обработать результат
                            function completed(data) {
                                result = data['filter.web_rule_update'];
                                if(result !== '')
                                    alert(result);   
                                else 
                                    alert('Имя правила и статус сохранены.');   
                            }
                        }"></i></div>
            <div class="form-control p-0 m-0 border-0" style="background: #0000;">
                <label class="text-dark editor_off" id="label_name_{{ rule.id }}" 
                       for="name_{{ rule.id }}">{{ rule.name }}</label>
                <input id="name_{{ rule.id }}" value="{{ rule.name }}" type="text"
                       style="width: 100%; font-size: 0.9em; height: 21px;"
                       class="border border-info p-0 m-1 editor_on" hidden>
            </div>
        </div>
    </div>
    <!-- Атрибуты правила фильтрации -->
    {% include 'rulepg/rulepg_cell.html' with id_cat=1 id_rule=rule.id rule_cat=rule.cat1 %}
    {% include 'rulepg/rulepg_cell.html' with id_cat=2 id_rule=rule.id rule_cat=rule.cat2 %}
    {% include 'rulepg/rulepg_cell.html' with id_cat=3 id_rule=rule.id rule_cat=rule.cat3 %}
    {% include 'rulepg/rulepg_cell.html' with id_cat=4 id_rule=rule.id rule_cat=rule.cat4 %}
    {% include 'rulepg/rulepg_cell.html' with id_cat=5 id_rule=rule.id rule_cat=rule.cat5 %}
    {% include 'rulepg/rulepg_cell.html' with id_cat=6 id_rule=rule.id rule_cat=rule.cat6 %}
    <!-- Описание правила -->
    <div class="col px-1 mx-0 cell_focus" onclick="cell_click(this)">
        <p class="text-muted p-0 m-0">{{ rule.description }}</p>
    </div>
    <!-- Лог правила -->
    <div class="col px-1 mx-0" style="max-width: 30px; width: 30px;">
        <div class="form-check">
            <input class="form-check-input" type="checkbox" id="is_log">
            <label class="form-check-label" for="is_log" hidden></label>
        </div>
    </div>
</div>